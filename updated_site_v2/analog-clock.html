<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Analog Clock Lab</title>
    <!-- Tailwind CSS via CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- React and Babel from CDNs -->
    <script src="https://unpkg.com/react@17/umd/react.development.js" crossorigin></script>
    <script src="https://unpkg.com/react-dom@17/umd/react-dom.development.js" crossorigin></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  </head>
  <body class="bg-gray-100 text-gray-800">
    <div class="max-w-5xl mx-auto p-4">
      <a href="index.html" class="text-purple-600 hover:underline">&larr; Back to Home</a>
      <h2 class="text-3xl font-bold text-center text-purple-700 my-6">Analog Clock Lab</h2>
      <div id="root"></div>
    </div>
    <script type="text/babel" data-presets="typescript,react">
      // Destructure React hooks for convenience
      const { useEffect, useState, useMemo, useRef } = React;

      // Begin original source from interactive_analog_clock_grade_5_teaching_lab_svg_react (1).jsx
      // Removed import line and replaced export default with plain function definition
      /* eslint-disable */
      /* eslint-disable react/prop-types */
      // Source: Interactive Analog Clock â€” Grade 5 Teaching Lab

      function ClockTeachingLab() {
        // --------- Clock state ---------
        const now = new Date();
        const [h, setH] = useState(now.getHours() % 12);
        const [m, setM] = useState(now.getMinutes());
        const [s, setS] = useState(now.getSeconds());

        // Live ticking unless paused
        const [isPaused, setIsPaused] = useState(false);
        // Whether minute hand is being dragged
        const draggingRef = useRef(false);

        // Derived values
        const hourAngle = useMemo(() => (h + m / 60) * 30, [h, m]);
        const minuteAngle = useMemo(() => m * 6, [m]);
        const secondAngle = useMemo(() => s * 6, [s]);

        // Start ticking every second
        useEffect(() => {
          if (isPaused) return;
          const timer = setInterval(() => {
            setS((sec) => {
              const newSec = (sec + 1) % 60;
              if (newSec === 0) {
                setM((min) => (min + 1) % 60);
                if ((m + 1) % 60 === 0) setH((hr) => (hr + 1) % 12);
              }
              return newSec;
            });
          }, 1000);
          return () => clearInterval(timer);
        }, [isPaused, m]);

        // Handle minute hand drag
        const svgRef = useRef(null);
        useEffect(() => {
          const svg = svgRef.current;
          const handleMouseDown = (e) => {
            const { left, top, width, height } = svg.getBoundingClientRect();
            const cx = left + width / 2;
            const cy = top + height / 2;
            const mouseX = e.clientX - cx;
            const mouseY = e.clientY - cy;
            const angle = (Math.atan2(mouseY, mouseX) * 180) / Math.PI;
            const deg = (angle + 450) % 360;
            const minuteIndex = Math.round(deg / 6) % 60;
            setM(minuteIndex);
            draggingRef.current = true;
          };
          const handleMouseMove = (e) => {
            if (!draggingRef.current) return;
            const { left, top, width, height } = svg.getBoundingClientRect();
            const cx = left + width / 2;
            const cy = top + height / 2;
            const mouseX = e.clientX - cx;
            const mouseY = e.clientY - cy;
            const angle = (Math.atan2(mouseY, mouseX) * 180) / Math.PI;
            const deg = (angle + 450) % 360;
            const minuteIndex = Math.round(deg / 6) % 60;
            setM(minuteIndex);
          };
          const handleMouseUp = () => {
            if (draggingRef.current) {
              draggingRef.current = false;
            }
          };
          svg.addEventListener("mousedown", handleMouseDown);
          window.addEventListener("mousemove", handleMouseMove);
          window.addEventListener("mouseup", handleMouseUp);
          return () => {
            svg.removeEventListener("mousedown", handleMouseDown);
            window.removeEventListener("mousemove", handleMouseMove);
            window.removeEventListener("mouseup", handleMouseUp);
          };
        }, []);

        return (
          <div className="flex flex-col items-center space-y-6">
            <div className="relative">
              <svg
                ref={svgRef}
                viewBox="0 0 200 200"
                className="w-80 h-80 cursor-pointer select-none"
              >
                {/* clock face */}
                <circle cx="100" cy="100" r="95" stroke="#EEE" strokeWidth="4" fill="#FFF" />
                {/* hour marks */}
                {[...Array(12).keys()].map((i) => {
                  const angle = (i / 12) * 2 * Math.PI;
                  const x1 = 100 + Math.cos(angle) * 80;
                  const y1 = 100 + Math.sin(angle) * 80;
                  const x2 = 100 + Math.cos(angle) * 90;
                  const y2 = 100 + Math.sin(angle) * 90;
                  return <line key={i} x1={x1} y1={y1} x2={x2} y2={y2} stroke="#000" strokeWidth={3} />;
                })}
                {/* minute marks */}
                {[...Array(60).keys()].map((i) => {
                  const angle = (i / 60) * 2 * Math.PI;
                  const x1 = 100 + Math.cos(angle) * 85;
                  const y1 = 100 + Math.sin(angle) * 85;
                  const x2 = 100 + Math.cos(angle) * 90;
                  const y2 = 100 + Math.sin(angle) * 90;
                  return <line key={i} x1={x1} y1={y1} x2={x2} y2={y2} stroke="#AAA" strokeWidth={1} />;
                })}
                {/* hour hand */}
                <line
                  x1="100"
                  y1="100"
                  x2={100 + 50 * Math.cos(((hourAngle - 90) * Math.PI) / 180)}
                  y2={100 + 50 * Math.sin(((hourAngle - 90) * Math.PI) / 180)}
                  stroke="#000"
                  strokeWidth={4}
                  strokeLinecap="round"
                />
                {/* minute hand */}
                <line
                  x1="100"
                  y1="100"
                  x2={100 + 70 * Math.cos(((minuteAngle - 90) * Math.PI) / 180)}
                  y2={100 + 70 * Math.sin(((minuteAngle - 90) * Math.PI) / 180)}
                  stroke="#1D4ED8"
                  strokeWidth={3}
                  strokeLinecap="round"
                />
                {/* second hand */}
                <line
                  x1="100"
                  y1="100"
                  x2={100 + 80 * Math.cos(((secondAngle - 90) * Math.PI) / 180)}
                  y2={100 + 80 * Math.sin(((secondAngle - 90) * Math.PI) / 180)}
                  stroke="#DC2626"
                  strokeWidth={2}
                  strokeLinecap="round"
                />
                {/* centre */}
                <circle cx="100" cy="100" r="5" fill="#000" />
              </svg>
            </div>
            <div className="flex space-x-4">
              <button
                onClick={() => setIsPaused((p) => !p)}
                className="px-4 py-2 rounded bg-purple-600 text-white font-semibold hover:bg-purple-700"
              >
                {isPaused ? "Play" : "Pause"}
              </button>
              <button
                onClick={() => {
                  const newTime = new Date();
                  setH(newTime.getHours() % 12);
                  setM(newTime.getMinutes());
                  setS(newTime.getSeconds());
                }}
                className="px-4 py-2 rounded bg-gray-300 text-gray-800 font-semibold hover:bg-gray-400"
              >
                Reset
              </button>
            </div>
            <div className="mt-4 text-center">
              <p className="text-xl font-mono">
                {h.toString().padStart(2, "0")}:{m.toString().padStart(2, "0")}:{s.toString().padStart(2, "0")}
              </p>
              <p className="text-sm text-gray-600">
                {h === 0 ? 12 : h}:{m.toString().padStart(2, "0")} {h < 12 ? "AM" : "PM"}
              </p>
            </div>
          </div>
        );
      }

      // Render the clock
      ReactDOM.render(<ClockTeachingLab />, document.getElementById("root"));
    </script>
  </body>
</html>